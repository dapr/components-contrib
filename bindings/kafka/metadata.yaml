# yaml-language-server: $schema=../../component-metadata-schema.json
schemaVersion: v1
type: bindings
name: kafka
version: v1
status: stable
title: "Apache Kafka"
urls:
  - title: Reference
    url: https://docs.dapr.io/reference/components-reference/supported-bindings/kafka/
binding:
  output: true
  input: true
  operations:
    - name: create
      description: "Publish a new message in the topic."
authenticationProfiles:
  - title: "OIDC Authentication"
    description: |
      Authenticate using OIDC.
    metadata:
      - name: authType
        type: string
        required: true
        description: |
          Configure or disable authentication.
        allowedValues:
          - "oidc"
      - name: oidcTokenEndpoint
        type: string
        required: true
        description: |
          Full URL to an OAuth2 identity provider access token endpoint.
        example: '"https://identity.example.com/v1/token"'
      - name: oidcClientID
        description: |
          The OAuth2 client ID that has been provisioned in the identity provider.
        example: '"dapr-kafka"'
        type: string
        required: true
      - name: oidcClientSecret
        type: string
        required: true
        sensitive: true
        description: |
          The OAuth2 client secret that has been provisioned in the identity provider.
        example: '"KeFg23!"'
      - name: oidcScopes
        type: string
        description: |
          Comma-delimited list of OAuth2/OIDC scopes to request with the access token.
          Recommended when authType is set to oidc.
        example: '"openid,kafka-prod"'
        default: '"openid"'
  - title: "SASL Authentication"
    description: |
      Authentication using SASL.
    metadata:
      - name: authType
        type: string
        required: true
        description: |
          Configure or disable authentication.
        allowedValues:
          - "password"
      - name: saslUsername
        type: string
        required: true
        description: |
          The SASL username used for authentication.
        example: '"myuser"'
      - name: saslPassword
        type: string
        required: true
        senstive: true
        description: |
          The SASL password used for authentication.
        example: '"mypassword"'
      - name: saslMechanism
        type: string
        required: true
        description: |
          The SASL Authentication Mechanism you wish to use.
        example: '"SHA-512"'
        default: '"PLAINTEXT"'
  - title: "MTLS Authentication"
    description: |
      Authentication using MTLS.
    metadata:
      - name: authType
        type: string
        required: true
        description: |
          Configure or disable authentication.
        allowedValues:
          - "mtls"
      - name: caCert
        type: string
        required: true
        description: "Certificate authority certificate."
        example: "-----BEGIN CERTIFICATE-----\n<base64-encoded DER>\n-----END CERTIFICATE-----"
      - name: clientCert
        required: true
        sensitive: true
        description: "Client certificate."
        example: "-----BEGIN CERTIFICATE-----\n<base64-encoded DER>\n-----END CERTIFICATE-----"
        type: string
      - name: clientKey
        type: string
        required: true
        sensitive: true
        description: "Client key."
        example: "-----BEGIN RSA PRIVATE KEY-----\n<base64-encoded DER>\n-----END RSA PRIVATE KEY-----"
      - name: skipVerify
        required: false
        description: |
          Skip TLS verification, this is not recommended for use in production.
        example: "true"
        default: "false"
        type: bool
      - name: disableTls
        required: false
        description: |
          Disable TLS for transport security. This is not recommended for use in production.
        example: "true"
        default: "false"
        type: bool
metadata:
  - name: topics
    type: string
    description: |
      A comma-separated list of subscribe topics.
    example: '"mytopic1,topic2"'
    binding:
      input: true
  - name: brokers
    type: string
    required: true
    description: |
      A comma-separated list of Kafka brokers.
    example: '"localhost:9092,dapr-kafka.myapp.svc.cluster.local:9093"'
    binding:
      output: true
      input: true
  - name: publishTopic
    type: string
    required: true
    description: |
      The topic to publish to.
    example: '"mytopic"'
    binding:
      output: true
  - name: consumerGroup
    type: string
    description: |
      A kafka consumer group to listen on. Each record published
      to a topic is delivered to one consumer within each consumer
      group subscribed to the topic.
    example: '"group1"'
    binding:
      input: true
  - name: clientID
    type: string
    description: |
      A user-provided string sent with every request to
      the Kafka brokers for logging, debugging, and auditing purposes.
    example: '"my-dapr-app"'
  - name: initialOffset
    type: string
    description: |
      The initial offset to use if no offset was previously committed.
      Should be "newest" or "oldest".
    example: '"oldest"'
    default: '"newest", "oldest"'
    allowedValues:
      - "newest"
      - "oldest"
    binding:
      input: true
  - name: maxMessageBytes
    type: number
    description: |
      The maximum size in bytes allowed for a single Kafka message.
    example: '2048'
    default: '1024'
  - name: consumeRetryInterval
    type: duration
    description: |
      The interval between retries when attempting to consume topics.
    example: '"200ms"'
    default: '"100ms"'
  - name: consumeRetryEnabled
    type: bool
    description: |
      Disables consumer retry by setting this to "false".
    example: '"true"'
  - name: version
    type: string
    description: |
      Kafka cluster version.
    example: '"0.10.2.0"'
    default: '"2.0.0.0"'